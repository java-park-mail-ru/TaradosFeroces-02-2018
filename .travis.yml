sudo: required

services:
  - docker

#branches:
#  only:
#  - develop
#  - sandbox
#  - docker

before_install:
      - sudo apt-get update
      - sudo apt-get install apt-transport-https ca-certificates
      - sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
      - echo "deb https://apt.dockerproject.org/repo ubuntu-precise main" | sudo tee /etc/apt/sources.list.d/docker.list
      - sudo apt-get update
      - sudo apt-get install docker-engine
      - sudo docker pull ubuntu
      - docker build -t deadlinez -f Dockerfile ./
      - docker images
      - docker tag deadlinez $DOCKER_USERNAME/deadlinez
      - docker push $DOCKER_USERNAME/deadlinez

install:
      - docker run --rm -p 8080:8080 $DOCKER_USERNAME/deadlinez


deploy:
  provider: heroku
  api_key:
    secure: $HEROKU_API_KEY
  app: deadlinez
  on:
    repo: Alex-Kuz/TaradosFeroces-02-2018
    branch: docker
  skip_cleanup: true
